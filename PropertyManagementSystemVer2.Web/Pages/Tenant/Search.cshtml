@page
@model PropertyManagementSystemVer2.Web.Pages.Tenant.SearchModel
@{
    ViewData["Title"] = "T√¨m ki·∫øm B·∫•t ƒë·ªông s·∫£n";
}

<div class="mb-20">
    <div class="page-title">T√¨m ki·∫øm B·∫•t ƒë·ªông s·∫£n</div>
    <div class="page-desc">T√¨m thu√™ nh√† ph√π h·ª£p v·ªõi nhu c·∫ßu c·ªßa b·∫°n</div>
</div>

<form method="get" class="card mb-20">
    <div style="display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 12px;">
        <div class="header-search" style="flex: 2; min-width: 200px;">
            <i data-feather="search" style="color: var(--text-muted); width: 14px;"></i>
            <input asp-for="SearchKeyword" placeholder="T√¨m ki·∫øm t√™n, qu·∫≠n, th√†nh ph·ªë..." style="width: 100%;" />
        </div>
        <input class="form-control" asp-for="City" placeholder="Th√†nh ph·ªë" style="flex: 1; min-width: 120px;" />
    </div>
    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
        <select class="form-control" asp-for="PropertyType" style="width: auto; flex: 1; min-width: 120px;">
            <option value="">Lo·∫°i BDS (T·∫•t c·∫£)</option>
            <option value="Apartment">CƒÉn h·ªô</option>
            <option value="House">Nh√† ph·ªë</option>
            <option value="Room">Ph√≤ng tr·ªç</option>
            <option value="Villa">Bi·ªát th·ª±</option>
            <option value="Commercial">M·∫∑t b·∫±ng</option>
        </select>
        <input class="form-control" type="number" asp-for="MinPrice" placeholder="Gi√° t·ª´ (VND)" style="flex: 1; min-width: 140px;" />
        <input class="form-control" type="number" asp-for="MaxPrice" placeholder="Gi√° ƒë·∫øn (VND)" style="flex: 1; min-width: 140px;" />
        <select class="form-control" asp-for="MinBedrooms" style="width: auto; flex: 1; min-width: 120px;">
            <option value="">Ph√≤ng ng·ªß</option>
            <option value="1">‚â• 1 ph√≤ng ng·ªß</option>
            <option value="2">‚â• 2 ph√≤ng ng·ªß</option>
            <option value="3">‚â• 3 ph√≤ng ng·ªß</option>
            <option value="4">‚â• 4 ph√≤ng ng·ªß</option>
            <option value="5">‚â• 5 ph√≤ng ng·ªß</option>
        </select>
        <button type="submit" class="btn btn-primary btn-sm">
            <i data-feather="filter" style="width: 13px;"></i> L·ªçc
        </button>
        <a href="Search" class="btn btn-ghost btn-sm">
            <i data-feather="x" style="width: 13px;"></i> Xo√° l·ªçc
        </a>
    </div>
    <div class="mt-8 text-muted text-sm">T√¨m th·∫•y @Model.Properties.Count b·∫•t ƒë·ªông s·∫£n ph√π h·ª£p</div>
</form>

<div class="property-grid">
    @if (Model.Properties != null && Model.Properties.Any())
    {
        foreach (var p in Model.Properties)
        {
            <div class="property-card" style="position: relative;">
                <button style="position: absolute; top: 10px; right: 10px; z-index: 1; background: rgba(0,0,0,0.5); border: none; border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; cursor: pointer; color: #fff;">
                    <i data-feather="heart" style="width: 14px; height: 14px;"></i>
                </button>
                @if (!string.IsNullOrEmpty(p.ThumbnailUrl))
                {
                    <img class="property-image" src="@p.ThumbnailUrl" alt="@p.Title" />
                }
                else
                {
                    <div class="property-image-placeholder">üè†</div>
                }
                <div class="property-body">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 6px;">
                        <span class="property-type-badge">@p.PropertyType</span>
                        @if (p.Status.ToString() == "Available")
                        {
                            <span class="badge badge-success">C√≤n tr·ªëng</span>
                        }
                        else
                        {
                            <span class="badge badge-info">@p.Status</span>
                        }
                    </div>
                    <div class="property-title">@p.Title</div>
                    <div class="property-address"><i data-feather="map-pin" style="width: 12px; height: 12px;"></i> @p.City</div>
                    <div class="property-specs">
                        <span class="spec-item"><i data-feather="home" style="width: 13px; height: 13px;"></i> ID: @p.Id</span>
                    </div>
                    <div style="border-top: 1px solid var(--border); padding-top: 12px; display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <div class="property-price">@p.MonthlyRent.ToString("N0")</div>
                            <div class="property-price-sub">/th√°ng</div>
                        </div>
                        <div style="display: flex; gap: 6px;">
                            @if (p.Status.ToString() == "Available")
                            {
                                <button class="btn btn-ghost btn-sm" onclick="alert('Xem nh√†!')">üìÖ Xem nh√†</button>
                                <button class="btn btn-primary btn-sm" onclick="alert('N·ªôp ƒë∆°n!')">N·ªôp ƒë∆°n</button>
                            }
                            else if (p.Status.ToString() == "Rented")
                            {
                                <button class="btn btn-secondary btn-sm" disabled>ƒê√£ thu√™</button>
                            }
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    else
    {
        <div class="empty-state" style="grid-column: 1 / -1;">
            <div class="empty-icon">üîç</div>
            <p>Kh√¥ng t√¨m th·∫•y b·∫•t ƒë·ªông s·∫£n n√†o ph√π h·ª£p v·ªõi b·ªô l·ªçc hi·ªán t·∫°i.</p>
        </div>
    }
</div>
